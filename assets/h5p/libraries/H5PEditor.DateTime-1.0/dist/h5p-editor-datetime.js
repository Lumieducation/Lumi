!function(){"use strict";let e=function(){function e(){}return e.extend=function(){for(let e=1;e<arguments.length;e++)for(let t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&("object"==typeof arguments[0][t]&&"object"==typeof arguments[e][t]?this.extend(arguments[0][t],arguments[e][t]):arguments[0][t]=arguments[e][t]);return arguments[0]},e}(),t=function(){function t(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;this.parent=t,this.field=a,this.params=i,this.setValue=n,"text"===this.field?.type&&(this.changes=[],this.passReadies=!0,this.$container=H5P.jQuery("<div>",{class:"h5peditor-datetime"}),this.fieldInstance=new H5PEditor.widgets[this.field.type](this.parent,this.field,this.params,this.setValue),this.fieldInstance.appendTo(this.$container),this.inputField=this.fieldInstance.$input.get(0),this.localization=this.getLocalization(navigator.language),this.field.datetime=e.extend({zebraOptions:{direction:!0,days:this.localization.weekdays,months:this.localization.months,show_select_today:H5PEditor.t("H5PEditor.DateTime","today"),lang_clear_date:H5PEditor.t("H5PEditor.DateTime","clearDate"),format:this.localization.dateTimePattern,onClose:()=>{this.handleDateChanged()},onSelect:()=>{this.handleDateChanged()},onClear:()=>{this.handleDateChanged()}}},this.field.datetime||{}),this.inputField.value=this.toLocalFormat(this.params),H5P.jQuery(this.inputField).Zebra_DatePicker?this.initZebraDatePicker():this.loadDatePickerLib((()=>{this.initZebraDatePicker()})),this.fieldInstance.changes&&this.fieldInstance.changes.push((()=>{this.handleFieldChange()})),this.$errors=this.$container.find(".h5p-errors"))}var a=t.prototype;return a.appendTo=function(e){this.$container.appendTo(e)},a.validate=function(){const e=""===(this.inputField?.value??"")?"":this.toISOString(this.inputField.value);return this.setValue(this.field,e),this.fieldInstance.validate()},a.remove=function(){this.$container.remove()},a.handleFieldChange=function(){this.params=this.fieldInstance.params,this.changes.forEach((e=>{e(this.params)}))},a.handleDateChanged=function(){const e=""===(this.inputField?.value??"")?"":this.toISOString(this.inputField.value);this.setValue(this.field,e),H5P.jQuery(this.inputField).change()},a.loadDatePickerLib=function(e){H5P.jQuery.ajax({url:`${H5PEditor.basePath}libs/zebra_datepicker.min.js`,dataType:"script",success:e,error:(e,t)=>{},async:!0})},a.initZebraDatePicker=function(){this.observer=new IntersectionObserver((e=>{if(1===e[0].intersectionRatio){this.observer.unobserve(this.inputField);const e=this.inputField?.parentNode;if(!e)return;const t=e.querySelector(".Zebra_DatePicker_Icon");if(!t)return;e.style.display="inline-block",e.style.position="relative",e.style.float="none",t.style.top=(this.inputField.offsetHeight-t.offsetHeight)/2+"px",t.style.right="10px"}}),{root:document.documentElement,threshold:[1]}),this.observer.observe(this.inputField),H5P.jQuery(this.inputField).Zebra_DatePicker(this.field.datetime.zebraOptions)},a.getDatePattern=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.language;return new Intl.DateTimeFormat(e,{year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts().map((e=>"month"===e.type?"m":"day"===e.type?"d":"year"===e.type?"Y":e.value)).join("")},a.toISOString=function(e){if("string"!=typeof e)return e;const t=this.localization.dateTimePattern.replace("d","\\d+").replace("Y","(\\d+)").replace("m","\\d+").replace("H","\\d+").replace("i","\\d+").replace("s","\\d+"),a=this.localization.dateTimePattern.replace("d","\\d+").replace("Y","\\d+").replace("m","(\\d+)").replace("H","\\d+").replace("i","\\d+").replace("s","\\d+"),i=this.localization.dateTimePattern.replace("d","(\\d+)").replace("Y","\\d+").replace("m","\\d+").replace("H","\\d+").replace("i","\\d+").replace("s","\\d+"),n=this.localization.dateTimePattern.replace("d","\\d+").replace("Y","\\d+").replace("m","\\d+").replace("H","(\\d+)").replace("i","\\d+").replace("s","\\d+"),r=this.localization.dateTimePattern.replace("d","\\d+").replace("Y","\\d+").replace("m","\\d+").replace("H","\\d+").replace("i","(\\d+)").replace("s","\\d+"),s=this.localization.dateTimePattern.replace("d","\\d+").replace("Y","\\d+").replace("m","\\d+").replace("H","\\d+").replace("i","\\d+").replace("s","(\\d+)"),l=new Date(parseInt(e.match(new RegExp(t))[1]),parseInt(e.match(new RegExp(a))[1])-1,parseInt(e.match(new RegExp(i))[1]),parseInt(e.match(new RegExp(n))[1]),parseInt(e.match(new RegExp(r))[1]),parseInt(e.match(new RegExp(s))[1]));return"Invalid Date"===l.toString()?e:l.toISOString()},a.getLocalization=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.language;const t=[],a=new Intl.DateTimeFormat(e,{month:"long"});for(let e=0;e<12;e++)t.push(a.format(new Date(2e3,e,1)));const i=[],n=new Intl.DateTimeFormat(e,{weekday:"long"});for(let e=2;e<9;e++)i.push(n.format(new Date(2e3,0,e)));const r=this.getDatePattern(e);return{months:t,weekdays:i,datePattern:r,dateTimePattern:`${r} H:i:s`}},a.toLocalFormat=function(e){if(""===(e??""))return"";const t=new Date(e);return this.localization.dateTimePattern.replace("Y",`${t.getFullYear()}`.padStart(4,"0")).replace("m",`${t.getMonth()+1}`.padStart(2,"0")).replace("d",`${t.getDate()}`.padStart(2,"0")).replace("H",`${t.getHours()}`.padStart(2,"0")).replace("i",`${t.getMinutes()}`.padStart(2,"0")).replace("s",`${t.getSeconds()}`.padStart(2,"0"))},t}();H5PEditor.widgets.datetime=t}();
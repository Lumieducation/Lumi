!function(){"use strict";let t=function(){function t(t,e,i,n){this.parent=t,this.field=e,this.params=i,this.setValue=n,this.passReadies=!0,this.$container=H5P.jQuery("<div>",{class:"h5peditor-important-description"}),this.changes=[],this.fieldInstance=new H5PEditor.widgets[this.field.type](this.parent,this.field,this.params,this.setValue),this.fieldInstance.appendTo(this.$container),"function"==typeof this.fieldInstance.change?this.fieldInstance.change((()=>{this.handleFieldChange()})):Array.isArray(this.fieldInstance.changes)&&this.fieldInstance.changes.push((()=>{this.handleFieldChange()}));const s=H5PEditor.findLibraryAncestor(this.parent);if(void 0!==s.currentLibrary){const t=`${s.currentLibrary.split(" ")[0]}-${this.field.name}`.replace(/\.|_/g,"-");this.storageKey=`${t}-important-description-open`}const o=this.field?.importantDescription?.l10n||{};this.dictionary=this.createDictionary(["importantInstructions","hideImportantInstructions","example","showImportantInstructions","hide"].map((t=>{const e={};return e[t]=o[t]||void 0,e})));const r=this.findReference(this.$container.get(0));r&&(this.instructions=this.buildInstructions(this.field.importantDescription),this.instructions&&r.parentNode.insertBefore(this.instructions,r),this.showInstructionsButton=this.buildShowInstructionsButton(this.field.importantDescription),this.showInstructionsButton&&r.parentNode.insertBefore(this.showInstructionsButton,r),H5PEditor.storage.get(this.storageKey,(t=>{void 0!==t&&!0!==t||this.$container.get(0).classList.add("instructions-visible")}))),this.$errors=this.$container.find(".h5p-errors")}var e=t.prototype;return e.findReference=function(t){let e=t.querySelector(".h5peditor-field-description")||t.querySelector(".h5peditor-label-wrapper");return e=e?e.nextSibling:t.get(0).querySelector(".field").firstChild,e},e.buildInstructions=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.description&&!t.example)return;const e=document.createElement("div");e.classList.add("instructions");const i=document.createElement("div");i.classList.add("header"),e.appendChild(i);const n=document.createElement("div");n.classList.add("title"),n.innerText=this.dictionary.importantInstructions,i.appendChild(n);const s=document.createElement("button");s.classList.add("close-button"),s.setAttribute("aria-label",this.dictionary.hideImportantInstructions),s.innerText=this.dictionary.hide,s.addEventListener("click",(()=>{this.handleCloseInstructions()})),i.appendChild(s);const o=document.createElement("div");if(o.classList.add("body"),e.appendChild(o),t.description){const e=document.createElement("div");e.classList.add("description"),e.innerHTML=t.description,o.appendChild(e)}if(t.example){const e=document.createElement("div");e.classList.add("example");const i=document.createElement("div");i.classList.add("example-title"),i.innerText=this.dictionary.example,e.appendChild(i);const n=document.createElement("div");n.classList.add("example-text"),n.innerHTML=t.example,e.appendChild(n),o.appendChild(e)}return e},e.buildShowInstructionsButton=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=document.createElement("div");e.classList.add("show-instructions-button-wrapper");const i=document.createElement("button");return i.classList.add("show-instructions-button"),i.innerText=this.dictionary.showImportantInstructions,i.addEventListener("click",(()=>{this.handleOpenInstructions()})),e.appendChild(i),t.floatingButton&&i.classList.add("floating"),e},e.handleOpenInstructions=function(){this.$container.get(0).classList.add("instructions-visible"),H5PEditor.storage.set(this.storageKey,!0)},e.handleCloseInstructions=function(){this.$container.get(0).classList.remove("instructions-visible"),H5PEditor.storage.set(this.storageKey,!1)},e.handleFieldChange=function(){this.params=this.fieldInstance.params,this.changes.forEach((t=>{t(this.params)}))},e.createDictionary=function(){const t={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((e=>{const i=Object.keys(e).length?Object.keys(e)[0]:void 0;i&&void 0!==Object.values(e)[0]?t[i]=e[i]:i&&0!==H5PEditor.t("core",Object.keys(e)[0]).indexOf("Missing translation")?t[i]=H5PEditor.t("core",i):t[i]=H5PEditor.t("H5PEditor.ImportantDescription",i)})),t},e.appendTo=function(t){this.$container.appendTo(t)},e.validate=function(){return this.fieldInstance.validate()},e.remove=function(){this.$container.remove()},t}();H5PEditor.widgets.importantDescription=t}();
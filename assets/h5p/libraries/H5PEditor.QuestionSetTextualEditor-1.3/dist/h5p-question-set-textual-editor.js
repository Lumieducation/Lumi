(()=>{var e={743:(e,r,t)=>{"use strict";function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.d(r,{A:()=>v});var i=function(){function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.multiChoiceLibrary=r,this.$cleaner=H5P.jQuery("<div/>")}var r,t;return r=e,(t=[{key:"parse",value:function(e){return this.parseTextLines(e.split("\n"))}},{key:"parseTextLines",value:function(e){return e.reduce(this.parseTextLine.bind(this),[]).map(this.finalizeQuestion)}},{key:"parseTextLine",value:function(e,r,t,n){if(!this.isBlankLine(r))if(this.isQuestion(n,t))e.push(this.parseQuestion(r));else{var i=e[e.length-1],a=this.parseAnswer(r);i.params.answers.push(a)}return e}},{key:"parseQuestion",value:function(e){return{library:this.multiChoiceLibrary,params:{question:this.cleanTextLine(e),answers:[],behaviour:{singleAnswer:!0}}}}},{key:"parseAnswer",value:function(e){var r=this.splitAnswerString(this.cleanTextLine(e)),t=this.trim(r[0]);return{text:this.removeLeadingAsterisk(t),correct:this.hasLeadingAsterisk(t),tipsAndFeedback:{tip:this.trim(r[1]),chosenFeedback:this.trim(r[2]),notChosenFeedback:this.trim(r[3])}}}},{key:"trim",value:function(e){if(void 0!==e&&e.length>0)return e.trim()}},{key:"finalizeQuestion",value:function(e){var r=e.params.answers.reduce((function(e){return e.correct?1:0}),0);return e.params.behaviour.singleAnswer=r<=1,e}},{key:"isBlankLine",value:function(e){return void 0!==e&&0===e.length}},{key:"isQuestion",value:function(e,r){return 0===r||this.isBlankLine(e[r-1])}},{key:"cleanTextLine",value:function(e){return this.$cleaner.text(e).html()}},{key:"removeLeadingAsterisk",value:function(e){return this.hasLeadingAsterisk(e)?e.trim().substr(1,e.length):e}},{key:"hasLeadingAsterisk",value:function(e){return null!=e&&"*"===e.substr(0,1)}},{key:"splitAnswerString",value:function(e){return e.replace(/\\:/g,"Â¤").split(":",4)}}])&&n(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),e}();function a(){return a=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a.apply(this,arguments)}function s(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,r,t){return r&&s(e.prototype,r),t&&s(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=H5P.jQuery,c=c||window.H5PEditor||{},l=function(e,r){if(void 0!==c.t)return c.t("H5PEditor.QuestionSetTextualEditor",e,r)},h="\n",p="H5P.MultiChoice 1.16",f=!1,v=o((function e(r){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e);try{var t=a({},c.LibraryListCache.librariesComingIn,c.LibraryListCache.libraryCache);for(var n in t)if("H5P.MultiChoice"===H5P.libraryFromString(n).machineName){p=n;break}}catch(e){}var s=this,o=!1;s.textParser=new i(p),s.helpText=l("helpText")+"<pre>"+l("example")+"</pre>";var v=u("<textarea/>",{id:r.getId(),"aria-describedby":r.getDescriptionId(),rows:20,css:{resize:"none"},placeholder:l("example"),on:{change:function(){b()}}}),d=u("<div/>"),b=function(){var e=r.getValue();r.removeAllItems(),s.textParser.parse(v.val()).forEach((function(t){var n=s.recycleQuestion(e,t);r.addItem(n)}))};s.recycleQuestion=function(e,r){var t=s.splitQuestionText(r.params.question);if(s.canRecycleQuestion(t)){var n=t[1]-1,i=t[2],a=e[n]||r;return a.library===p&&(a.params.question=i,a.params.answers=r.params.answers,a.params.behaviour.singleAnswer=r.params.behaviour.singleAnswer),a}return r},s.canRecycleQuestion=function(e){return null!==e&&3===e.length},s.splitQuestionText=function(e){return e.match(/^(\d+)\.\s?(.+)$/)};var y=function(e){return void 0!==e.getName?e.getName():e.field.name},m=function(e,r,t){return e?(""!==(e=e.replace(/(<[^>]*>|\r\n|\n|\r)/gm,"").trim())&&(r&&(e=r+e),t&&(e+=t)),e):""};s.addMultiChoice=function(e,r){var t="";return e.forEachChild((function(e){switch(y(e)){case"question":t=m(e.validate(),r+1+". ",h)+t;break;case"answers":e.forEachChild((function(e){var r="",n="",i="";e.forEachChild((function(e){switch(y(e)){case"text":r+=m(e.validate()).replace(/:/g,"\\:");break;case"correct":e.value&&(r="*"+r);break;case"tipsAndFeedback":e.forEachChild((function(e){switch(y(e)){case"chosenFeedback":n=m(e.validate()).replace(/:/g,"\\:")+(null==n?"":n);break;case"notChosenFeedback":n+=m(e.validate().replace(/:/g,"\\:"),":");break;case"tip":i=m(e.validate()).replace(/:/g,"\\:")}}))}})),""!==n&&(i+=":"+n),""!==i&&(r+=":"+i),""!==r&&(t+=r+h)}))}})),t},s.addItem=function(e,r){var t;switch(e.currentLibrary){case p:t=s.addMultiChoice(e,r);break;default:t=r+1+". "+l("unknownQuestionType")+h;case void 0:}if(f||void 0===e.currentLibrary||o||(o=!0),t){d.html(t),t=d.text();var n=v.val();""!==n&&(n+=h),v.val(n+t)}},s.appendTo=function(e){v.appendTo(e),o&&!f&&(alert(l("warning")),f=!0)},s.remove=function(){v.remove()}}))}},r={};function t(n){var i=r[n];if(void 0!==i)return i.exports;var a=r[n]={exports:{}};return e[n](a,a.exports,t),a.exports}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),H5PEditor.QuestionSetTextualEditor=t(743).A})();